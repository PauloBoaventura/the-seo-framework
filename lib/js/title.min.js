'use strict';window.tsfTitle=function(a){const b="undefined"!=typeof tsfTitleL10n&&tsfTitleL10n;let c,d={allowReferenceChange:!0,useTagline:b.states.useTagline,separator:b.states.titleSeparator,additionPlacement:b.states.additionPlacement,prefixPlacement:b.states.prefixPlacement,additionValue:b.states.additionValue,prefixValue:"",defaultTitle:b.states.defaultTitle},e="",f="";const g=document.getElementById("tsf-title-placeholder-prefix")||a("</span>")[0],h=document.getElementById("tsf-title-placeholder")||a("</span>")[0],i=a=>a?a in d?d[a]:void 0:d,j=()=>{let a="",b=d.useTagline&&tsf.escapeString(tsf.sDoubleSpace(d.additionValue.trim()))||"";if(b)switch(d.additionPlacement){case"before":a=b+" "+d.separator+" ";break;case"after":a=" "+d.separator+" "+b;}e=a||"",h.innerHTML=e},k=()=>{let a="",b=tsf.escapeString(tsf.sDoubleSpace(d.prefixValue));if(b)switch(d.prefixPlacement){case"before":a=b+" ";break;case"after":a=" "+b;}f=a||"",g.innerHTML=f},l=b=>{let c=a(b.target).siblings("input").first();if(c.length){let a=c[0];switch(a.focus(),b.detail){case 3:a.setSelectionRange(0,a.value.length);break;case 2:let c,e;"tsf-title-placeholder"===b.target.id&&"after"===d.additionPlacement||"tsf-title-placeholder-prefix"===b.target.id&&tsf.l10n.states.isTRL?(c=a.value.replace(/([0-9A-Z_a-z]+|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)$/u,"").length,e=a.value.length):(c=0,e=a.value.length-a.value.replace(/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+|[0-9A-Z_a-z]+)/u,"").length),a.setSelectionRange(c,e);break;case 1:default:let f="tsf-title-placeholder"===b.target.id&&"after"===d.additionPlacement?a.value.length:0;a.setSelectionRange(f,f);}}},m=b=>{let c=document.getElementById("tsf-title-reference"),g=b.target.value;if(c){if(g=g.trim(),1>g.length||!d.allowReferenceChange)g=b.target.placeholder;else{if(f.length)switch(d.additionPlacement){case"before":g=f+g;break;case"after":g+=f;}if(e.length)switch(d.additionPlacement){case"before":g=e+g;break;case"after":g+=e;}}c.innerHTML=tsf.decodeEntities(tsf.sDoubleSpace(g)),setTimeout(()=>{a(c).change()},0)}},n=function(b){if(!h&&!g)return;let c=a(b.target),i=c.val(),j=!!e.length,k=!!f.length;if(!j&&h&&(h.style.display="none"),!k&&g&&(g.style.display="none"),!j&&!k)return void c.css("text-indent","initial");if(!i.length)return c.css("text-indent","initial"),h&&(h.style.display="none"),void(g&&(g.style.display="none"));let l=c.outerWidth(!0),m=(c.outerHeight(!0)-c.height())/2,n=(l-c.innerWidth())/2,o=tsf.l10n.states.isRTL?"right":"left",p=(c.outerWidth(!0)-c.width())/2,q={display:c.css("display"),lineHeight:c.css("lineHeight"),fontFamily:c.css("fontFamily"),fontWeight:c.css("fontWeight"),fontSize:c.css("fontSize"),letterSpacing:c.css("letterSpacing"),paddingTop:m+"px",paddingBottom:m+"px"},r=a(g),s=a(h),t=0,u=0,v=0,w=0,x=0,y=0;if(k&&(r.css(q),r.css({maxWidth:"initial"}),x=r[0].getBoundingClientRect().width,x<y&&(x=0)),j){let b=0;switch((()=>{let c=a("#tsf-title-offset");c.text(i),c.css({fontFamily:q.fontFamily,fontWeight:q.fontWeight,letterSpacing:q.letterSpacing,fontSize:q.fontSize}),b=c[0].getBoundingClientRect().width})(),t=c[0].getBoundingClientRect().width-n-p-b-x,t<y&&(x+=t,t=0),s.css(q),s.css({maxWidth:"initial"}),d.additionPlacement){case"before":let e=s[0].getBoundingClientRect().width;e=t<e?t:e,e<y&&(e=0),t=e,w+=t,v+=t,u+=p;break;case"after":u+=p+b+x;}}v+=p,x=0>x?0:x,w+=x;let z;k&&(z={},z[o]=v+"px",z.maxWidth=x+"px",r.css(z)),j&&(z={},z[o]=u+"px",z.maxWidth=t+"px",s.css(z)),z={},z["text-indent"]=w+"px",c.css(z)},o=a=>{if(a.target.value||!d.allowReferenceChange)return;let b=d.defaultTitle.trim();if(f.length)switch(d.prefixPlacement){case"before":b=f+b;break;case"after":b+=f;}if(e.length)switch(d.additionPlacement){case"before":b=e+b;break;case"after":b+=e;}let c=document.createElement("span");c.innerHTML=tsf.escapeString(tsf.sDoubleSpace(b.trim())),a.target.placeholder=tsf.unescapeString(c.textContent)},p=a=>{let b=document.getElementById(a.target.id+"_chars"),c=document.getElementById("tsf-title-reference");b&&c&&tsfC.updateCharacterCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"title",type:"search"})},q=a=>{let b=document.getElementById(a.target.id+"_pixels"),c=document.getElementById("tsf-title-reference");b&&c&&tsfC.updatePixelCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"title",type:"search"})},r=()=>{a(c).trigger("input.tsfUpdateTitles")},s=()=>{a(c).trigger("tsf-update-title-counter")},t=a=>{n(a),o(a),m(a),u(a)},u=a=>{p(a),q(a)};let v=0;const w=()=>{clearTimeout(v),v=setTimeout(r,10)},x=()=>{if(!tsfAys)r();else{let a=tsfAys.getChangedState;r(),a||tsfAys.reset()}};let y=0;const z=()=>{clearTimeout(y),y=setTimeout(x,10)};let A=0,B=window.innerWidth;const C=()=>{clearTimeout(A),A=setTimeout(()=>{let a=window.innerWidth;B<a?782>=B&&782<=a&&x():782<=B&&782>=a&&x(),B=a},50)},D=()=>{g.addEventListener("click",l),h.addEventListener("click",l),window.addEventListener("resize",C),a(window).on("tsf-counter-updated",w)},E=()=>!c instanceof Element?void console.log("tsfTitle: Doing it wrong! Register the title input at \"tsf-onload\". Debug me."):void(a(c).on("input.tsfUpdateTitles",t),a(c).on("tsf-update-title-counter",u),j(),k(),z());return Object.assign({load:()=>{a(document.body).on("tsf-onload",D),a(document.body).on("tsf-ready",E)}},{setInputElement:a=>{c=a},getState:i,updateState:(a,b)=>{switch(d[a]=b,a){case"prefixValue":case"prefixPlacement":k(),w();break;case"useTagline":case"separator":case"additionValue":case"additionPlacement":j(),w();break;case"allowReferenceChange":case"defaultTitle":default:w();}},triggerCounter:s,triggerInput:r,enqueueTriggerInput:w,triggerUnregisteredInput:x,enqueueUnregisteredInputTrigger:z},{l10n:b})}(jQuery),jQuery(window.tsfTitle.load);
