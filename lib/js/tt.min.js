'use strict';window.tsfTT=function(a){const b=()=>{let b,f,g=0,h=!1,i=!1,j={},k={};try{let a=Object.defineProperty({},"passive",{get:()=>{i=!0}});window.addEventListener("tsf-tt-test-passive",a,a).removeEventListener("tsf-tt-test-passive",a,a)}catch(a){}const l=()=>{h=!0,clearTimeout(g),g=setTimeout(()=>{h=!1},300)},m=(b,c)=>{c=c||!1;let d=a(b);c?(d.off("mousemove.tsfTT mouseleave.tsfTT mouseout.tsfTT blur.tsfTT"),a(document.body).off("pointerdown.tsfTT touchstart.tsfTT click.tsfTT")):(d.on({"mousemove.tsfTT":t,"mouseleave.tsfTT":u,"mouseout.tsfTT":u,"blur.tsfTT":u}),a(document.body).off("pointerdown.tsfTT touchstart.tsfTT click.tsfTT").on("pointerdown.tsfTT touchstart.tsfTT click.tsfTT",v)),d.off("tsf-tooltip-update").on("tsf-tooltip-update",o)},n=a=>m(a,!0),o=b=>{if(b.target.classList.contains("tsf-tooltip-item")){let c=b.target.querySelector(".tsf-tooltip-text");c instanceof Element&&(c.innerHTML=b.target.dataset.desc,a(b.target).trigger("mousemove.tsfTT"))}},p=()=>{b=requestAnimationFrame(r)},q=()=>{f=void 0,k={tooltip:void 0,arrow:void 0,wrap:void 0},j={last:{x:void 0},curr:{x:void 0}},cancelAnimationFrame(b)},r=()=>{var a=Math.round;let b=![j.curr.x].includes(NaN);if(b&&j.curr.x===j.last.x)return void p();j.last.x=j.curr.x;const c=f;let d=k.tooltip||c&&c.target.querySelector(".tsf-tooltip");if(!d)return void p();k.tooltip||(k.tooltip=d),k.arrow||(k.arrow=d.querySelector(".tsf-tooltip-arrow")),k.wrap||(k.wrap=c.target.closest(".tsf-tooltip-wrap")||c.target.parentNode);let e=j.curr.x;"focus"===c.type?e=c.target.getBoundingClientRect().left+c.target.offsetWidth/2:isNaN(e)&&(e=k.tooltip.dataset.lastPagex||c.target.getBoundingClientRect().left),k.tooltip.dataset.lastPagex=e;let g=e-k.wrap.getBoundingClientRect().left-8,h=k.tooltip.querySelector(".tsf-tooltip-text-wrap"),i=h.offsetWidth,l=k.tooltip.dataset.adjust,m=i-16-7;if(l=parseInt(l,10),l=isNaN(l)?0:a(l),l&&(g-=l,m+l>k.wrap.offsetWidth)){let a=h.querySelector(".tsf-tooltip-text"),b=a.offsetWidth;m=b-16-7}k.arrow.style.left=7>=g?"7px":g>=m?m+"px":g+"px",b?p():q()},s=a=>{let b=a.target.dataset.desc||a.target.title||"";b&&!a.target.getElementsByClassName("tsf-tooltip").length&&(a.target.dataset.desc=b,a.target.removeAttribute("title"),c(a,a.target,b))},t=a=>{j.curr.x=a.pageX||NaN,f=a},u=a=>{h||(e(a.target),n(a.target),q())},v=a=>{l();let b,c=".tsf-tooltip-item";if(a.target.classList.contains("tsf-tooltip-item")&&(b=a.target),!b){let d=a.target.querySelectorAll(c);for(const a of d)if(a.querySelector(".tsf-tooltip")){b=a;break}}if(b)for(const a of document.querySelectorAll(c))a!==b&&(e(a),n(a));else{for(const a of document.querySelectorAll(c))e(a),n(a);q()}},w=a=>{if(h)return;if(a.target.dataset.hasTooltip)return;let b=!1;switch(a.type){case"mouseenter":break;case"pointerdown":case"touchstart":b=!0;break;case"focus":default:}b?(l(),v(a)):a.target.dataset.preventedClick=1,q(),s(a),t(a),p(),m(a.target)},x=a=>{a.target.dataset.preventedClick||(a.preventDefault(),setTimeout(()=>a.target.dataset.preventedClick=1))};let y=!1;const z=a=>{y||(y=!0,a.target.classList.contains("tsf-tooltip-item")&&w(a),a.stopPropagation(),y=!1)};let A;const B=!i||{capture:!0,passive:!0},C=()=>{clearTimeout(A),A=setTimeout(()=>{let a=document.querySelectorAll(".tsf-tooltip-wrap"),b=["mouseenter","pointerdown","touchstart","focus"];for(let c=0;c<a.length;c++)b.forEach(b=>{a[c].addEventListener(b,z,B)}),a[c].addEventListener("click",x)},25)};C(),a(window).on("tsf-tooltip-reset",C),d("#wpwrap")},c=(b,c,d)=>{var f=Math.min;if(c instanceof a&&(c=c.get(0)),c.dataset.hasTooltip=1,c.querySelector(".tsf-tooltip")&&e(c),!d.length)return;let g=document.createElement("div");g.classList.add("tsf-tooltip"),g.insertAdjacentHTML("afterbegin",`<span class="tsf-tooltip-text-wrap"><span class="tsf-tooltip-text">${d}</span></span><div class="tsf-tooltip-arrow" style=will-change:left></div>`),c.prepend(g);let h=c.closest(".tsf-tooltip-boundary")||document.body,i=h.getBoundingClientRect(),j=i.top-(h.scrollTop||0),k=h.offsetWidth,l=12,m=c.closest(".tsf-tooltip-wrap")||c.parentElement,n=m.getBoundingClientRect(),o=g.querySelector(".tsf-tooltip-text-wrap"),p=o.getBoundingClientRect(),q=n.width;250<p.width&&250>q&&150<q&&(o.style.flexBasis=q+"px"),o.offsetWidth>k-l/2?(o.style.flexBasis=f(250,k-l)+"px",l/=2):250<p.width&&(o.style.flexBasis="250px");let r=i.left-(h.scrollLeft||0),s=r+k,t=o.offsetWidth,u=p.left,v=u+t,w=0;if(u<r)w=r-u+l;else if(v>s)w=s-u-t-l;else if(42>q)w=-q/2-l;else if(q>t){let a=b&&b.pageX||NaN;w=b&&"focus"===b.type?q/2-t/2:isNaN(a)?-l:a-n.left-t/2;let c=-l,d=q-t+l;w<c&&(w=c),w>d&&(w=d)}if(w+u<r+l){let a=w+u-(r+l/2);w-=a}if(w+v>s+l){let a=w+v-(s+l/2);w-=a}if(w+u<r&&(w=0),!b){let a=parseInt(o.style.flexBasis,10);w<-a&&(w=-a)}g.style.left=w+"px",g.dataset.adjust=w;let x=c.offsetHeight+8,y=g.getBoundingClientRect().top-x;j>y?(g.classList.add("tsf-tooltip-down"),g.style.top=x+"px"):g.style.bottom=x+"px"},d=b=>{a(b).addClass("tsf-tooltip-boundary")},e=b=>{b instanceof a&&(b=b.get(0)),b instanceof HTMLElement&&(delete b.dataset.hasTooltip,delete b.dataset.preventedClick),f(b).remove()},f=b=>a(b).find(".tsf-tooltip").first();return Object.assign({load:()=>{a(document.body).ready(b)}},{doTooltip:c,removeTooltip:e,getTooltip:f,addBoundary:d,triggerReset:()=>{window.dispatchEvent(new CustomEvent("tsf-tooltip-reset"))},triggerUpdate:b=>{a(b||".tsf-tooltip-item").trigger("tsf-tooltip-update")}})}(jQuery),jQuery(window.tsfTT.load);
