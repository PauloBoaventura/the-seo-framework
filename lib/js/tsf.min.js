'use strict';window.tsf={nonces:tsfL10n.nonces,i18n:tsfL10n.i18n,states:tsfL10n.states,params:tsfL10n.params,settingsChanged:!1,hasInput:!1,browseUnhappy:!!navigator.userAgent.match(/Trident\/7\./),confirm:function(a){return confirm(a)},stripTags:function(a){return a.replace(/(<([^>]+)?>?)/ig,"")},escapeString:function(a){if(!a.length)return"";let b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\\\\":"&#92;","\\":""};return a.replace(/[&<>"']|\\\\|\\/g,a=>b[a])},unescapeString:function(a){if(!a.length)return"";let b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\\":"&#92;"},c={};c=tsf.browseUnhappy?Object.keys(b).map(a=>b[a]):Object.values(b);let d=new RegExp(c.map(a=>a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")).join("|"),"g");return tsf.browseUnhappy?a.replace(d,a=>{for(let c in b)if(b[c]===a)return c;return a}):a.replace(d,a=>Object.keys(b).find(c=>b[c]===a))},sDoubleSpace:function(a){return a.replace(/\s\s+/g," ")},getStringLength:function(a){let b,c=0;return a.length&&(b=document.createElement("span"),b.innerHTML=tsf.escapeString(a).trim(),"undefined"!=typeof b.childNodes[0]&&(c=b.childNodes[0].nodeValue.length)),+c},convertJSONResponse:function(a){let b=a&&a.json||void 0,c=1===b;if(!c){let b=a;try{a=JSON.parse(a),c=!0}catch(a){c=!1}c||(a=b)}return a},_initTitleInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_title, #autodescription-meta\\[doctitle\\], #autodescription-site-settings\\[homepage_title\\]");if(!a.length)return;let b,c,d,e,f=!1,g="",h="",i=tsf.params.titleSeparator,j=tsf.params.defaultTitle,k=tsf.states.useTagline,l=tsf.states.isRTL,m=tsf.states.isPrivate,n=tsf.states.isPasswordProtected,o=tsf.states.stripTitleTags;b=l?"after":"before";const p=function(){let a="before";tsf.states.isSettingsPage?l?"right"===jQuery("#tsf-home-title-location input:checked").val()&&(a="after"):"left"===jQuery("#tsf-home-title-location input:checked").val()&&(a="after"):l?"left"===tsf.params.titleLocation&&(a="after"):"right"===tsf.params.titleLocation&&(a="after"),c=a};p();const q=function(){let a="";if(!tsf.states.isSettingsPage)k&&(a=tsf.params.titleAdditions);else if(k){let b=document.getElementById("autodescription-site-settings[homepage_title_tagline]"),c=b&&b.value||"";c=tsf.sDoubleSpace(c.trim()),a=c.length?c:tsf.params.blogDescription}a.length&&(a=tsf.escapeString(tsf.sDoubleSpace(a.trim())),"before"===c?a=a+" "+i+" ":"after"===c?a=" "+i+" "+a:void 0);h=a.length?a:"",e=document.getElementById("tsf-title-placeholder"),h.length&&e&&(e.innerHTML=h)};q();const r=function(){let a="";m?a=tsf.i18n.privateTitle:n&&(a=tsf.i18n.protectedTitle);a.length&&(a=tsf.escapeString(a),"before"===b?a+=" ":"after"===b?a=" "+a:void 0);g=a.length?a:"",g.length&&d&&(d.innerHTML=g),d=document.getElementById("tsf-title-placeholder-prefix"),g.length&&d&&(d.innerHTML=g)};r();const s=function(a){if(!e&&!d)return;let b=jQuery(a.target),f=b.val(),i=!!h.length,j=!!g.length;if(!i&&e&&(e.style.display="none"),!j&&d&&(d.style.display="none"),!i&&!j)return void b.css("text-indent","initial");if(!f.length)return b.css("text-indent","initial"),e&&(e.style.display="none"),void(d&&(d.style.display="none"));let k=b.outerWidth(!0),m=(b.outerHeight(!0)-b.height())/2,n=(k-b.innerWidth())/2,o=l?"right":"left",p=(b.outerWidth(!0)-b.width())/2,q={display:b.css("display"),lineHeight:b.css("lineHeight"),fontFamily:b.css("fontFamily"),fontWeight:b.css("fontWeight"),fontSize:b.css("fontSize"),letterSpacing:b.css("letterSpacing"),paddingTop:m+"px",paddingBottom:m+"px"},r=jQuery(d),s=jQuery(e),t=0,u=0,v=0,w=0,x=0,y=0;if(j&&(r.css(q),r.css({maxWidth:"initial"}),x=r[0].getBoundingClientRect().width,x<y&&(x=0)),i){let a=0;switch(function(){let b=jQuery("#tsf-title-offset");b.text(f),b.css({fontFamily:q.fontFamily,fontWeight:q.fontWeight,letterSpacing:q.letterSpacing,fontSize:q.fontSize}),a=b[0].getBoundingClientRect().width}(),t=b[0].getBoundingClientRect().width-n-p-a-x,t<y&&(x+=t,t=0),s.css(q),s.css({maxWidth:"initial"}),c){case"before":let d=s[0].getBoundingClientRect().width;d=t<d?t:d,d<y&&(d=0),t=d,w+=t,v+=t,u+=p;break;case"after":u+=p+a+x;}}v+=p,x=0>x?0:x,w+=x;let z;j&&(z={},z[o]=v+"px",z.maxWidth=x+"px",r.css(z)),i&&(z={},z[o]=u+"px",z.maxWidth=t+"px",s.css(z)),z={},z["text-indent"]=w+"px",b.css(z)},t=function(){let d="",e=!!h.length,i=!!g.length,k=h,l=g;d=j;i&&("before"===b?d=l+d:"after"===b?d+=l:void 0);e&&("before"===c?d=k+d:"after"===c?d+=k:void 0);tsf.browseUnhappy&&(f=!0);let m=document.createElement("span");m.innerHTML=tsf.escapeString(tsf.sDoubleSpace(d)),a.prop("placeholder",tsf.unescapeString(m.textContent)),tsf.browseUnhappy&&setTimeout(function(){f=!1},0)},u=function(a){let d=document.getElementById("tsf-title-reference"),e=a.target.value;d&&(e=e.trim(),1>e.length||tsf.states.homeLocks.refTitleLock?e=a.target.placeholder:(g.length&&("before"===b?e=g+e:"after"===b?e+=g:void 0),h.length&&("before"===c?e=h+e:"after"===c?e+=h:void 0)),d.innerHTML=tsf.escapeString(tsf.sDoubleSpace(e)),setTimeout(()=>{jQuery(d).change()},0))},v=a=>{let b=document.getElementById(a.target.id+"_chars"),c=document.getElementById("tsf-title-reference");b&&c&&tsfC.updateCharacterCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"title",type:"search"})},w=function(a){let b=document.getElementById(a.target.id+"_pixels"),c=document.getElementById("tsf-title-reference");b&&c&&tsfC.updatePixelCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"title",type:"search"})},x=function(a){return!f&&void(s(a),t(),u(a),v(a),w(a))};a.on("input.tsfUpdateTitles",x);a.on("tsf-update-title-counter",function(a){u(a),v(a),w(a)});const y=function(){a.trigger("tsf-update-title-counter")},z=function(){q(),D()};jQuery("#autodescription-site-settings\\[homepage_title_tagline\\]").on("input",z),jQuery("#autodescription-site-settings\\[homepage_tagline\\]").on("change",z);const A=function(a){let b=k;jQuery(a.target).is(":checked")?(jQuery(".tsf-custom-blogname-js").css("display","inline"),k=!0):(jQuery(".tsf-custom-blogname-js").css("display","none"),k=!1),b^k&&(q(),F())};jQuery("#tsf-title-tagline-toggle :input").on("click",A);const B=a=>{switch(m=!1,n=!1,a){case"password":n=!0;break;case"private":m=!0;break;default:case"public":}r(),F()};jQuery(document).on("tsf-updated-gutenberg-visibility",(a,b)=>B(b));jQuery("#visibility .save-post-visibility").on("click",()=>{let a=jQuery("#visibility").find("input:radio:checked").val();if("password"===a){let b=jQuery("#visibility").find("#post_password").val(),c=!!b&&!!b.length;c||(a="public")}B(a)});const C=function(a){let b=jQuery(a.target).val(),c="";switch(b){case"pipe":c="|";break;case"dash":c="-";break;default:c=jQuery("<div/>").html("&"+b+";").text();}i=c,jQuery(".tsf-sep-js").text(" "+i+" "),q(),F()};jQuery("#tsf-title-separator :input").on("click",C);const D=function(){a.trigger("input.tsfUpdateTitles")};let E=0;const F=function(){clearTimeout(E),E=setTimeout(D,10)};jQuery(window).on("tsf-counter-updated",F);const G=function(){let a=tsf.settingsChanged;D(),tsf.settingsChanged=a};let H=0;const I=function(){clearTimeout(H),H=setTimeout(G,10)};jQuery(window).on("tsf-flex-resize",I),jQuery("#tsf-homepage-tab-general").on("tsf-tab-toggled",I),jQuery("#tsf-flex-inpost-tab-general").on("tsf-flex-tab-toggled",I),I();let J=["autodescription-homepage-settings","tsf-inpost-box"];jQuery(document).on("postbox-toggled",function(a,b){if(0<=J.indexOf(b.id)){let a=b.querySelector(".inside");0<a.offsetHeight&&0<a.offsetWidth&&G()}});jQuery("#tsf-home-title-location :input").on("click",function(){p(),q(),F()});const K=function(a){a="string"==typeof a&&a.trim()||"",j=a.length?tsf.escapeString(o?tsf.stripTags(a):a):tsf.params.untitledTitle,t(),y()};tsf.states.isHome||(jQuery("#edittag #name, #titlewrap #title").on("input",a=>K(a.target.value)),jQuery(document).on("tsf-updated-gutenberg-title",(a,b)=>K(b)));const L=function(a){if(!tsf.states.taglineLocked){let b=k;k=!jQuery(a.target).is(":checked"),b^k&&(q(),F())}};tsf.states.isHome||(jQuery("#autodescription_title_no_blogname").on("change",L),jQuery("#autodescription_title_no_blogname").trigger("change"));(function(){let a=0,b=window.innerWidth;window.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(function(){let a=window.innerWidth;b<a?782>=b&&782<=a&&G():782<=b&&782>=a&&G(),b=a},50)})})()},_initUnboundTitleSettings:function(){if(tsf.hasInput){jQuery("#tsf-title-placeholder, #tsf-title-placeholder-prefix").on("click",function(a){let b=jQuery("#autodescription_title, #autodescription-meta\\[doctitle\\], #autodescription-site-settings\\[homepage_title\\]"),c=jQuery(a.target).siblings(b)[0];if("function"==typeof c.setSelectionRange){c.focus();let a=2*c.value.length;c.setSelectionRange(a,a)}else{let a=c.value;c.value="",c.focus(),c.value=a}})}},_initDescInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_description, #autodescription-meta\\[description\\], #autodescription-site-settings\\[homepage_description\\]");if(!a.length)return;const b=a=>{let b=document.getElementById(a.target.id+"_chars"),c=document.getElementById("tsf-description-reference");b&&c&&tsfC.updateCharacterCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"description",type:"search"})},c=function(a){let b=document.getElementById("tsf-description-reference"),c=a.target.value;b&&(c=c.trim(),(1>c.length||tsf.states.homeLocks.refDescriptionLock)&&(c=a.target.placeholder),b.innerHTML=tsf.escapeString(tsf.sDoubleSpace(c)),setTimeout(()=>{jQuery(b).change()},0))},d=function(a){let b=document.getElementById(a.target.id+"_pixels"),c=document.getElementById("tsf-description-reference");b&&c&&tsfC.updatePixelCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"description",type:"search"})};a.on("input.tsfUpdateDescriptions",function(a){c(a),b(a),d(a)});const e=function(){a.trigger("input.tsfUpdateDescriptions")};let f=0;const g=function(){clearTimeout(f),f=setTimeout(e,10)};jQuery(window).on("tsf-counter-updated",g);const h=function(){let a=tsf.settingsChanged;e(),tsf.settingsChanged=a};let i=0;const j=function(){clearTimeout(i),i=setTimeout(h,10)};jQuery("#tsf-homepage-tab-general").on("tsf-tab-toggled",j),jQuery("#tsf-flex-inpost-tab-general").on("tsf-flex-tab-toggled",j),j();let k=["autodescription-homepage-settings","tsf-inpost-box"];jQuery(document).on("postbox-toggled",function(a,b){if(0<=k.indexOf(b.id)){let a=b.querySelector(".inside");0<a.offsetHeight&&0<a.offsetWidth&&g()}})},_initSocialTitleInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_og_title, #autodescription-site-settings\\[homepage_og_title\\]"),b=jQuery("#autodescription_twitter_title, #autodescription-site-settings\\[homepage_twitter_title\\]"),c=jQuery("#tsf-title-reference");if(!a.length||!b.length||!c.length)return;let d=!1,e=tsf.states.homeLocks.ogTitleLock,f=tsf.states.homeLocks.ogTitlePHLock,g=tsf.states.homeLocks.twTitleLock,h=tsf.states.homeLocks.twTitlePHLock,i=e?a.prop("placeholder"):a.val(),j=g?b.prop("placeholder"):b.val(),k=c.text();const l=c=>{let d="";switchActive:switch(c){case"twitter":if(d=j,g||h){d=d.length?d:b.prop("placeholder");break switchActive}case"og":if(d=d.length?d:i,e||f){d=d.length?d:a.prop("placeholder");break switchActive}case"reference":d=d.length?d:k;}return d},m=()=>{tsf.browseUnhappy&&(d=!0),e||f||a.prop("placeholder",l("reference")),g||h||b.prop("placeholder",l("og")),tsf.browseUnhappy&&setTimeout(()=>{d=!1},0)},n=(a,b,c)=>{let d=document.getElementById(a.id+"_chars");d&&tsfC.updateCharacterCounter({e:d,text:tsf.unescapeString(b),field:"title",type:c})};let o=0;const p=()=>{clearTimeout(o),o=setTimeout(()=>{a.each((a,b)=>n(b,l("og"),"opengraph")),b.each((a,b)=>n(b,l("twitter"),"twitter"))},10)};c.on("change",()=>{k=c.text(),m(),p()});const q=a=>{if(!d){if(!e){let b=a.target.value.trim();i=b.length?tsf.sDoubleSpace(b):""}m(),p()}},r=a=>{if(!d){if(!g){let b=a.target.value.trim();j=b.length?tsf.sDoubleSpace(b):""}m(),p()}};a.on("input.tsfUpdateOgTitle",q),b.on("input.tsfUpdateTwTitle",r)},_initSocialDescInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_og_description, #autodescription-site-settings\\[homepage_og_description\\]"),b=jQuery("#autodescription_twitter_description, #autodescription-site-settings\\[homepage_twitter_description\\]"),c=jQuery("#tsf-description-reference");if(!a.length||!b.length||!c.length)return;let d=!1,e=tsf.states.homeLocks.ogDescriptionLock,f=tsf.states.homeLocks.ogDescriptionPHLock,g=tsf.states.homeLocks.twDescriptionLock,h=tsf.states.homeLocks.twDescriptionPHLock,i=e?a.prop("placeholder"):a.val(),j=g?b.prop("placeholder"):b.val(),k=c.text(),l=jQuery("#autodescription_description, #autodescription-meta\\[description\\], #autodescription-site-settings\\[homepage_description\\]");const m=(c,d)=>{let m="";switchActive:switch(c){case"twitter":if(m=j,g||h){m=m.length?m:b.prop("placeholder");break switchActive}case"og":if(m=m.length?m:i,e||f){m=m.length?m:a.prop("placeholder");break switchActive}case"reference":m.length||(l.val().length?m=k:"twitter"===d?m=tsf.params.socialPlaceholders.twDesc:"og"==d&&(m=tsf.params.socialPlaceholders.ogDesc));}return m},n=()=>{tsf.browseUnhappy&&(d=!0),e||f||a.attr("placeholder",m("reference","og")),g||h||b.attr("placeholder",m("og","twitter")),tsf.browseUnhappy&&setTimeout(function(){d=!1},0)},o=(a,b,c)=>{let d=document.getElementById(a.id+"_chars");d&&tsfC.updateCharacterCounter({e:d,text:tsf.unescapeString(b),field:"description",type:c})};let p=0;const q=()=>{clearTimeout(p),p=setTimeout(()=>{a.each((a,b)=>o(b,m("og","og"),"opengraph")),b.each((a,b)=>o(b,m("twitter","twitter"),"twitter"))},10)};c.on("change",()=>{k=c.text(),n(),q()});const r=a=>{if(!d){if(!e){let b=a.target.value.trim();i=b.length?tsf.sDoubleSpace(b):""}n(),q()}},s=a=>{if(!d){if(!g){let b=a.target.value.trim();j=b.length?tsf.sDoubleSpace(b):""}n(),q()}};a.on("input.tsfUpdateOgDesc",r),b.on("input.tsfUpdateOgDesc",s)},_initPostboxToggle:function(){let a;if(tsf.states.isSettingsPage?a=jQuery(".postbox[id^=\"autodescription-\"]").find(".hndle, .handlediv"):tsf.states.isPostEdit&&(a=jQuery(".postbox#tsf-inpost-box").find(".hndle, .handlediv")),!a||!a.length)return;let b;const c=()=>{try{b[0].reportValidity()}catch(a){let c=jQuery(b[0].form).find("input[type=submit]").not(".autodescription-site-settings\\[tsf-settings-reset\\]");c.length&&c[0].click()}},d=a=>{let d=jQuery(a.target).closest(".postbox");d[0].classList.contains("closed")&&(b=d.find("input:invalid, select:invalid, textarea:invalid"),b.length&&(jQuery(document).one("postbox-toggled",c),jQuery(a.target).trigger("click")))};a.on("click.tsfPostboxes",d)},attachUnsavedChangesListener:function(){if(!tsf.hasInput)return;const a=a=>{jQuery(a.data._input).not(a.data._except).off(a.type,b)},b=b=>{tsf.registerChange(),a(b)};let c;c=".tsf-metaboxes :input, #tsf-inpost-box .inside :input",jQuery(c).not(".tsf-input-not-saved").off("change.tsfChangeListener").on("change.tsfChangeListener",{_input:c,_except:".tsf-input-not-saved"},b),jQuery(document).off("tsf-gutenberg-saved-document.tsfChangeListener").on("tsf-gutenberg-saved-document.tsfChangeListener",()=>{tsf.settingsChanged=!1}),c=".tsf-metaboxes input[type=text], .tsf-metaboxes textarea, #tsf-inpost-box .inside input[type=text], #tsf-inpost-box .inside textarea",jQuery(c).not(".tsf-input-not-saved").off("input.tsfChangeListener").on("input.tsfChangeListener",{_input:c,_except:".tsf-input-not-saved"},b),jQuery(window).off("beforeunload.tsfChangeListener").on("beforeunload.tsfChangeListener",()=>{if(tsf.settingsChanged)return tsf.i18n.saveAlert}),jQuery(".tsf-metaboxes input[type=\"submit\"], #publishing-action input[type=\"submit\"], #save-action input[type=\"submit\"], a.submitdelete").off("click.tsfChangeListener").on("click.tsfChangeListener",()=>{tsf.settingsChanged=!1})},registerChange:function(){tsf.settingsChanged=!0},onLoadUnregisterChange:function(){tsf.settingsChanged=!1},dismissNotice:function(a){jQuery(a.target).parents(".tsf-notice").slideUp(200,function(){this.remove()})},setAjaxLoader:function(a){jQuery(a).toggleClass("tsf-loading")},unsetAjaxLoader:function(a,b){let c="tsf-success",d=2500;b||(c="tsf-error",d=5e3),jQuery(a).removeClass("tsf-loading").addClass(c).fadeOut(d)},resetAjaxLoader:function(a){jQuery(a).stop().empty().prop("class","tsf-ajax").css("opacity","1").removeProp("style")},_setResizeListeners:function(){jQuery(window).on("resize orientationchange",tsf._triggerResize),jQuery("#collapse-menu").click(tsf._triggerResize),jQuery(".columns-prefs :input[type=radio]").change(tsf._triggerResize),jQuery(".meta-box-sortables").on("sortupdate",tsf._triggerResize)},_triggerResize:function(){jQuery(window).trigger("tsf-flex-resize")},_triggerReady:function(){jQuery(document.body).trigger("tsf-ready")},_triggerOnLoad:function(){jQuery(document.body).trigger("tsf-onload")},_doReady:function(){tsf._triggerOnLoad(),tsf._initTitleInputs(),tsf._initUnboundTitleSettings(),tsf._initSocialTitleInputs(),tsf._initDescInputs(),tsf._initSocialDescInputs(),tsf._initPostboxToggle(),tsf.attachUnsavedChangesListener(),tsf.onLoadUnregisterChange(),tsf._triggerReady()},setupVars:function(){tsf.hasInput=tsf.states.hasInput},ready:function(a){tsf.setupVars(),a(".tsf-dismiss").on("click",tsf.dismissNotice),a(document.body).ready(tsf._doReady)}},jQuery(tsf.ready);
