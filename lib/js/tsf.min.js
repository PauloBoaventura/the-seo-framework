'use strict';window.tsf={nonces:tsfL10n.nonces,i18n:tsfL10n.i18n,states:tsfL10n.states,params:tsfL10n.params,hasInput:!1,confirm:function(a){return confirm(a)},stripTags:function(a){return a.replace(/(<([^>]+)?>?)/ig,"")},escapeString:function(a){if(!a.length)return"";let b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\\\\":"&#92;","\\":""};return a.replace(/[&<>"']|\\\\|\\/g,a=>b[a])},unescapeString:function(a){if(!a.length)return"";let b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","\\":"&#92;"},c={};c=Object.values(b);let d=new RegExp(c.map(a=>a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")).join("|"),"g");return a.replace(d,a=>Object.keys(b).find(c=>b[c]===a))},sDoubleSpace:function(a){return a.replace(/\s\s+/g," ")},getStringLength:function(a){let b,c=0;return a.length&&(b=document.createElement("span"),b.innerHTML=tsf.escapeString(a).trim(),"undefined"!=typeof b.childNodes[0]&&(c=b.childNodes[0].nodeValue.length)),+c},convertJSONResponse:function(a){let b=a&&a.json||void 0,c=1===b;if(!c){let b=a;try{a=JSON.parse(a),c=!0}catch(a){c=!1}c||(a=b)}return a},_initTitleInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_title, #autodescription-meta\\[doctitle\\], #autodescription-site-settings\\[homepage_title\\]");if(!a.length)return;let b,c,d,e,f="",g="",h=tsf.params.titleSeparator,i=tsf.params.defaultTitle,j=tsf.states.useTagline,k=tsf.states.isRTL,l=tsf.states.isPrivate,m=tsf.states.isPasswordProtected,n=tsf.states.stripTitleTags;b=k?"after":"before";const o=function(){let a="before";tsf.states.isSettingsPage?k?"right"===jQuery("#tsf-home-title-location input:checked").val()&&(a="after"):"left"===jQuery("#tsf-home-title-location input:checked").val()&&(a="after"):k?"left"===tsf.params.titleLocation&&(a="after"):"right"===tsf.params.titleLocation&&(a="after"),c=a};o();const p=function(){let a="";if(!tsf.states.isSettingsPage)j&&(a=tsf.params.titleAdditions);else if(j){let b=document.getElementById("autodescription-site-settings[homepage_title_tagline]"),c=b&&b.value||"";c=tsf.sDoubleSpace(c.trim()),a=c.length?c:tsf.params.blogDescription}a.length&&(a=tsf.escapeString(tsf.sDoubleSpace(a.trim())),"before"===c?a=a+" "+h+" ":"after"===c?a=" "+h+" "+a:void 0);g=a.length?a:"",e=document.getElementById("tsf-title-placeholder"),g.length&&e&&(e.innerHTML=g)};p();const q=function(){let a="";l?a=tsf.i18n.privateTitle:m&&(a=tsf.i18n.protectedTitle);a.length&&(a=tsf.escapeString(a),"before"===b?a+=" ":"after"===b?a=" "+a:void 0);f=a.length?a:"",f.length&&d&&(d.innerHTML=f),d=document.getElementById("tsf-title-placeholder-prefix"),f.length&&d&&(d.innerHTML=f)};q();const r=function(a){if(!e&&!d)return;let b=jQuery(a.target),h=b.val(),i=!!g.length,j=!!f.length;if(!i&&e&&(e.style.display="none"),!j&&d&&(d.style.display="none"),!i&&!j)return void b.css("text-indent","initial");if(!h.length)return b.css("text-indent","initial"),e&&(e.style.display="none"),void(d&&(d.style.display="none"));let l=b.outerWidth(!0),m=(b.outerHeight(!0)-b.height())/2,n=(l-b.innerWidth())/2,o=k?"right":"left",p=(b.outerWidth(!0)-b.width())/2,q={display:b.css("display"),lineHeight:b.css("lineHeight"),fontFamily:b.css("fontFamily"),fontWeight:b.css("fontWeight"),fontSize:b.css("fontSize"),letterSpacing:b.css("letterSpacing"),paddingTop:m+"px",paddingBottom:m+"px"},r=jQuery(d),s=jQuery(e),t=0,u=0,v=0,w=0,x=0,y=0;if(j&&(r.css(q),r.css({maxWidth:"initial"}),x=r[0].getBoundingClientRect().width,x<y&&(x=0)),i){let a=0;switch(function(){let b=jQuery("#tsf-title-offset");b.text(h),b.css({fontFamily:q.fontFamily,fontWeight:q.fontWeight,letterSpacing:q.letterSpacing,fontSize:q.fontSize}),a=b[0].getBoundingClientRect().width}(),t=b[0].getBoundingClientRect().width-n-p-a-x,t<y&&(x+=t,t=0),s.css(q),s.css({maxWidth:"initial"}),c){case"before":let d=s[0].getBoundingClientRect().width;d=t<d?t:d,d<y&&(d=0),t=d,w+=t,v+=t,u+=p;break;case"after":u+=p+a+x;}}v+=p,x=0>x?0:x,w+=x;let z;j&&(z={},z[o]=v+"px",z.maxWidth=x+"px",r.css(z)),i&&(z={},z[o]=u+"px",z.maxWidth=t+"px",s.css(z)),z={},z["text-indent"]=w+"px",b.css(z)},s=function(){let d="",e=!!g.length,h=!!f.length,j=g,k=f;d=i;h&&("before"===b?d=k+d:"after"===b?d+=k:void 0);e&&("before"===c?d=j+d:"after"===c?d+=j:void 0);let l=document.createElement("span");l.innerHTML=tsf.escapeString(tsf.sDoubleSpace(d)),a.prop("placeholder",tsf.unescapeString(l.textContent))},t=function(a){let d=document.getElementById("tsf-title-reference"),e=a.target.value;d&&(e=e.trim(),1>e.length||tsf.states.homeLocks.refTitleLock?e=a.target.placeholder:(f.length&&("before"===b?e=f+e:"after"===b?e+=f:void 0),g.length&&("before"===c?e=g+e:"after"===c?e+=g:void 0)),d.innerHTML=tsf.escapeString(tsf.sDoubleSpace(e)),setTimeout(()=>{jQuery(d).change()},0))},u=a=>{let b=document.getElementById(a.target.id+"_chars"),c=document.getElementById("tsf-title-reference");b&&c&&tsfC.updateCharacterCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"title",type:"search"})},v=function(a){let b=document.getElementById(a.target.id+"_pixels"),c=document.getElementById("tsf-title-reference");b&&c&&tsfC.updatePixelCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"title",type:"search"})};a.on("input.tsfUpdateTitles",function(a){r(a),s(),t(a),u(a),v(a)});a.on("tsf-update-title-counter",function(a){t(a),u(a),v(a)});const w=function(){a.trigger("tsf-update-title-counter")},x=function(){p(),B()};jQuery("#autodescription-site-settings\\[homepage_title_tagline\\]").on("input",x),jQuery("#autodescription-site-settings\\[homepage_tagline\\]").on("change",x);const y=function(a){let b=j;jQuery(a.target).is(":checked")?(jQuery(".tsf-custom-blogname-js").css("display","inline"),j=!0):(jQuery(".tsf-custom-blogname-js").css("display","none"),j=!1),b^j&&(p(),D())};jQuery("#tsf-title-tagline-toggle :input").on("click",y);const z=a=>{switch(l=!1,m=!1,a){case"password":m=!0;break;case"private":l=!0;break;default:case"public":}q(),D()};jQuery(document).on("tsf-updated-gutenberg-visibility",(a,b)=>z(b));jQuery("#visibility .save-post-visibility").on("click",()=>{let a=jQuery("#visibility").find("input:radio:checked").val();if("password"===a){let b=jQuery("#visibility").find("#post_password").val(),c=!!b&&!!b.length;c||(a="public")}z(a)});const A=function(a){let b=jQuery(a.target).val(),c="";switch(b){case"pipe":c="|";break;case"dash":c="-";break;default:c=jQuery("<div/>").html("&"+b+";").text();}h=c,jQuery(".tsf-sep-js").text(" "+h+" "),p(),D()};jQuery("#tsf-title-separator :input").on("click",A);const B=function(){a.trigger("input.tsfUpdateTitles")};let C=0;const D=function(){clearTimeout(C),C=setTimeout(B,10)};jQuery(window).on("tsf-counter-updated",D);const E=function(){let a=tsfAys.getChangedState;B(),a||tsfAys.reset()};let F=0;const G=function(){clearTimeout(F),F=setTimeout(E,10)};jQuery(window).on("tsf-flex-resize",G),jQuery("#tsf-homepage-tab-general").on("tsf-tab-toggled",G),jQuery("#tsf-flex-inpost-tab-general").on("tsf-flex-tab-toggled",G),G();let H=["autodescription-homepage-settings","tsf-inpost-box"];jQuery(document).on("postbox-toggled",function(a,b){if(0<=H.indexOf(b.id)){let a=b.querySelector(".inside");0<a.offsetHeight&&0<a.offsetWidth&&E()}});jQuery("#tsf-home-title-location :input").on("click",function(){o(),p(),D()});const I=function(a){a="string"==typeof a&&a.trim()||"",i=a.length?tsf.escapeString(n?tsf.stripTags(a):a):tsf.params.untitledTitle,s(),w()};tsf.states.isHome||(jQuery("#edittag #name, #titlewrap #title").on("input",a=>I(a.target.value)),jQuery(document).on("tsf-updated-gutenberg-title",(a,b)=>I(b)));const J=function(a){if(!tsf.states.taglineLocked){let b=j;j=!jQuery(a.target).is(":checked"),b^j&&(p(),D())}};tsf.states.isHome||(jQuery("#autodescription_title_no_blogname").on("change",J),jQuery("#autodescription_title_no_blogname").trigger("change"));(function(){let a=0,b=window.innerWidth;window.addEventListener("resize",function(){clearTimeout(a),a=setTimeout(function(){let a=window.innerWidth;b<a?782>=b&&782<=a&&E():782<=b&&782>=a&&E(),b=a},50)})})()},_initUnboundTitleSettings:function(){if(tsf.hasInput){jQuery("#tsf-title-placeholder, #tsf-title-placeholder-prefix").on("click",function(a){let b=jQuery("#autodescription_title, #autodescription-meta\\[doctitle\\], #autodescription-site-settings\\[homepage_title\\]"),c=jQuery(a.target).siblings(b)[0];if("function"==typeof c.setSelectionRange){c.focus();let a=2*c.value.length;c.setSelectionRange(a,a)}else{let a=c.value;c.value="",c.focus(),c.value=a}})}},_initDescInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_description, #autodescription-meta\\[description\\], #autodescription-site-settings\\[homepage_description\\]");if(!a.length)return;const b=a=>{let b=document.getElementById(a.target.id+"_chars"),c=document.getElementById("tsf-description-reference");b&&c&&tsfC.updateCharacterCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"description",type:"search"})},c=function(a){let b=document.getElementById("tsf-description-reference"),c=a.target.value;b&&(c=c.trim(),(1>c.length||tsf.states.homeLocks.refDescriptionLock)&&(c=a.target.placeholder),b.innerHTML=tsf.escapeString(tsf.sDoubleSpace(c)),setTimeout(()=>{jQuery(b).change()},0))},d=function(a){let b=document.getElementById(a.target.id+"_pixels"),c=document.getElementById("tsf-description-reference");b&&c&&tsfC.updatePixelCounter({e:b,text:tsf.unescapeString(c.innerHTML),field:"description",type:"search"})};a.on("input.tsfUpdateDescriptions",function(a){c(a),b(a),d(a)});const e=function(){a.trigger("input.tsfUpdateDescriptions")};let f=0;const g=function(){clearTimeout(f),f=setTimeout(e,10)};jQuery(window).on("tsf-counter-updated",g);const h=function(){let a=tsfAys.getChangedState;e(),a||tsfAys.reset()};let i=0;const j=function(){clearTimeout(i),i=setTimeout(h,10)};jQuery("#tsf-homepage-tab-general").on("tsf-tab-toggled",j),jQuery("#tsf-flex-inpost-tab-general").on("tsf-flex-tab-toggled",j),j();let k=["autodescription-homepage-settings","tsf-inpost-box"];jQuery(document).on("postbox-toggled",function(a,b){if(0<=k.indexOf(b.id)){let a=b.querySelector(".inside");0<a.offsetHeight&&0<a.offsetWidth&&g()}})},_initSocialTitleInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_og_title, #autodescription-meta\\[og_title\\], #autodescription-site-settings\\[homepage_og_title\\]"),b=jQuery("#autodescription_twitter_title, #autodescription-meta\\[tw_title\\], #autodescription-site-settings\\[homepage_twitter_title\\]"),c=jQuery("#tsf-title-reference");if(!a.length||!b.length||!c.length)return;let d=tsf.states.homeLocks.ogTitleLock,e=tsf.states.homeLocks.ogTitlePHLock,f=tsf.states.homeLocks.twTitleLock,g=tsf.states.homeLocks.twTitlePHLock,h=d?a.prop("placeholder"):a.val(),i=f?b.prop("placeholder"):b.val(),j=c.text();const k=c=>{let k="";switchActive:switch(c){case"twitter":if(k=i,f||g){k=k.length?k:b.prop("placeholder");break switchActive}case"og":if(k=k.length?k:h,d||e){k=k.length?k:a.prop("placeholder");break switchActive}case"reference":k=k.length?k:j;}return k},l=()=>{d||e||a.prop("placeholder",k("reference")),f||g||b.prop("placeholder",k("og"))},m=(a,b,c)=>{let d=document.getElementById(a.id+"_chars");d&&tsfC.updateCharacterCounter({e:d,text:tsf.unescapeString(b),field:"title",type:c})};let n=0;const o=()=>{clearTimeout(n),n=setTimeout(()=>{a.each((a,b)=>m(b,k("og"),"opengraph")),b.each((a,b)=>m(b,k("twitter"),"twitter"))},10)};c.on("change",()=>{j=c.text(),l(),o()});a.on("input.tsfUpdateOgTitle",a=>{if(!d){let b=a.target.value.trim();h=b.length?tsf.sDoubleSpace(b):""}l(),o()}),b.on("input.tsfUpdateTwTitle",a=>{if(!f){let b=a.target.value.trim();i=b.length?tsf.sDoubleSpace(b):""}l(),o()})},_initSocialDescInputs:function(){if(!tsf.hasInput)return;let a=jQuery("#autodescription_og_description, #autodescription-meta\\[og_description\\], #autodescription-site-settings\\[homepage_og_description\\]"),b=jQuery("#autodescription_twitter_description, #autodescription-meta\\[tw_description\\], #autodescription-site-settings\\[homepage_twitter_description\\]"),c=jQuery("#tsf-description-reference");if(!a.length||!b.length||!c.length)return;let d=tsf.states.homeLocks.ogDescriptionLock,e=tsf.states.homeLocks.ogDescriptionPHLock,f=tsf.states.homeLocks.twDescriptionLock,g=tsf.states.homeLocks.twDescriptionPHLock,h=d?a.prop("placeholder"):a.val(),i=f?b.prop("placeholder"):b.val(),j=c.text(),k=jQuery("#autodescription_description, #autodescription-meta\\[description\\], #autodescription-site-settings\\[homepage_description\\]");const l=(c,l)=>{let m="";switchActive:switch(c){case"twitter":if(m=i,f||g){m=m.length?m:b.prop("placeholder");break switchActive}case"og":if(m=m.length?m:h,d||e){m=m.length?m:a.prop("placeholder");break switchActive}case"reference":m.length||(k.val().length?m=j:"twitter"===l?m=tsf.params.socialPlaceholders.twDesc:"og"==l&&(m=tsf.params.socialPlaceholders.ogDesc));}return m},m=()=>{d||e||a.attr("placeholder",l("reference","og")),f||g||b.attr("placeholder",l("og","twitter"))},n=(a,b,c)=>{let d=document.getElementById(a.id+"_chars");d&&tsfC.updateCharacterCounter({e:d,text:tsf.unescapeString(b),field:"description",type:c})};let o=0;const p=()=>{clearTimeout(o),o=setTimeout(()=>{a.each((a,b)=>n(b,l("og","og"),"opengraph")),b.each((a,b)=>n(b,l("twitter","twitter"),"twitter"))},10)};c.on("change",()=>{j=c.text(),m(),p()});a.on("input.tsfUpdateOgDesc",a=>{if(!d){let b=a.target.value.trim();h=b.length?tsf.sDoubleSpace(b):""}m(),p()}),b.on("input.tsfUpdateOgDesc",a=>{if(!f){let b=a.target.value.trim();i=b.length?tsf.sDoubleSpace(b):""}m(),p()})},_initPostboxToggle:function(){let a;if(tsf.states.isSettingsPage?a=jQuery(".postbox[id^=\"autodescription-\"]").find(".hndle, .handlediv"):tsf.states.isPostEdit&&(a=jQuery(".postbox#tsf-inpost-box").find(".hndle, .handlediv")),!a||!a.length)return;let b;const c=()=>{try{b[0].reportValidity()}catch(a){let c=jQuery(b[0].form).find("input[type=submit]").not(".autodescription-site-settings\\[tsf-settings-reset\\]");c.length&&c[0].click()}},d=a=>{let d=jQuery(a.target).closest(".postbox");d[0].classList.contains("closed")&&(b=d.find("input:invalid, select:invalid, textarea:invalid"),b.length&&(jQuery(document).one("postbox-toggled",c),jQuery(a.target).trigger("click")))};a.on("click.tsfPostboxes",d)},dismissNotice:function(a){jQuery(a.target).parents(".tsf-notice").slideUp(200,function(){this.remove()})},setAjaxLoader:function(a){jQuery(a).toggleClass("tsf-loading")},unsetAjaxLoader:function(a,b){let c="tsf-success",d=2500;b||(c="tsf-error",d=5e3),jQuery(a).removeClass("tsf-loading").addClass(c).fadeOut(d)},resetAjaxLoader:function(a){jQuery(a).stop().empty().prop("class","tsf-ajax").css("opacity","1").removeProp("style")},_setResizeListeners:function(){jQuery(window).on("resize orientationchange",tsf._triggerResize),jQuery("#collapse-menu").click(tsf._triggerResize),jQuery(".columns-prefs :input[type=radio]").change(tsf._triggerResize),jQuery(".meta-box-sortables").on("sortupdate",tsf._triggerResize)},_triggerResize:function(){jQuery(window).trigger("tsf-flex-resize")},_triggerReady:function(){jQuery(document.body).trigger("tsf-ready")},_triggerOnLoad:function(){jQuery(document.body).trigger("tsf-onload")},_doReady:function(){tsf._triggerOnLoad(),tsf._initTitleInputs(),tsf._initUnboundTitleSettings(),tsf._initSocialTitleInputs(),tsf._initDescInputs(),tsf._initSocialDescInputs(),tsf._initPostboxToggle(),tsf._triggerReady()},setupVars:function(){tsf.hasInput=tsf.states.hasInput},ready:function(a){tsf.setupVars(),a(".tsf-dismiss").on("click",tsf.dismissNotice),a(document.body).ready(tsf._doReady)}},jQuery(tsf.ready);
