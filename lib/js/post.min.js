'use strict';window.tsfPost=function(a){const b="undefined"!=typeof tsfPostL10n&&tsfPostL10n,c="autodescription_title",d="autodescription_description";let e={};const f=(b,c)=>{let d=a(b.target);if(!d.is(":checked"))return;c="boolean"==typeof c&&c;let f=b.target.id,g=b.target.name,h="tsf-flex-tab-content-active",i="tsf-flex-tab-active",j=a("."+h),k=d.closest(".tsf-flex-nav-tab-wrapper").find("."+i),l=j.find("input:invalid, select:invalid, textarea:invalid");if(l.length)return l[0].reportValidity(),k.prop("checked",!0),d.prop("checked",!1),b.stopPropagation(),b.preventDefault(),!1;if(k.removeClass(i),k.siblings("label").removeClass("tsf-no-focus-ring"),d.addClass(i),c){document.querySelectorAll("."+g+"-content").forEach(a=>{a.classList.remove(h),a.style.display="none"});let b=document.getElementById(f+"-content");b.classList.add(h),b.style.display=null,a("#"+f).trigger("tsf-flex-tab-toggled")}else{e.hasOwnProperty(g)||(e[g]={fadeOut:void 0,addClass:void 0,trigger:void 0});const b=150;if(clearTimeout(e[g].addClass),clearTimeout(e[g].trigger),"number"!=typeof e[g].fadeOut){e[g].fadeOut=setTimeout(()=>{e[g].fadeOut=void 0},b);let c=a("."+g+"-content");c.fadeOut(b,function(){a(this).removeClass(h)})}e[g].addClass=setTimeout(()=>{let b=a("#"+f+"-content");b.addClass(h).fadeIn(250)},150),e[g].trigger=setTimeout(()=>{a("#"+f).trigger("tsf-flex-tab-toggled")},175)}},g=()=>{if(!a(".tsf-flex").length)return;let b=0,c={},d=0,e=a(".tsf-flex-nav-tab-wrapper"),f=a(".tsf-flex-nav-tab-inner"),g=a(".tsf-flex-nav-name");if(e.length){a(window).on("tsf-flex-resize",()=>{clearTimeout(b);let a=0;b=setTimeout(()=>{let b=e.width(),d=f.width();c.tabWrapper||(c.tabWrapper={},c.tabWrapper.outer=0,c.tabWrapper.inner=0,c.tabWrapper.shown=1),!c.tabWrapper.shown&&c.tabWrapper.outer<b&&(g.fadeIn(250),setTimeout(()=>{d=f.width()},a)),setTimeout(()=>{d>b?(g.hide(),c.tabWrapper.shown=0):c.tabWrapper.outer<b&&(g.fadeIn(250),c.tabWrapper.shown=1)},2*a),setTimeout(()=>{c.tabWrapper.outer=b,c.tabWrapper.inner=d},3*a)},d),a=10,d=75});const h=()=>{a(window).trigger("tsf-flex-resize")};a(window).on("resize orientationchange",h),a("#collapse-menu").on("click",h),a(".columns-prefs :input[type=radio]").on("change",h),a(".meta-box-sortables").on("sortupdate",h),h()}},h=a=>{a.currentTarget.classList.add("tsf-no-focus-ring")},i=()=>{a(".tsf-flex-nav-tab-radio:checked").trigger("change",[!0])},j=()=>{let b=a("#autodescription_canonical");if(!b)return;const c=a=>{b.attr("placeholder",a)};a(document).on("tsf-updated-gutenberg-link",(a,b)=>c(b))},k=()=>{const d=document.getElementById(c),e=document.getElementById("autodescription_title_no_blogname");tsfTitle.setInputElement(d);let f=JSON.parse(document.getElementById("tsf-title-data_"+c).dataset.state);d.placeholder=tsf.escapeString(tsf.decodeEntities(f.placeholder.trim())),tsfTitle.updateStateFor(c,"allowReferenceChange",!f.refTitleLocked),tsfTitle.updateStateFor(c,"defaultTitle",tsf.escapeString(tsf.decodeEntities(f.defaultTitle.trim()))),tsfTitle.updateStateFor(c,"addAdditions",f.addAdditions),tsfTitle.updateStateFor(c,"useSocialTagline",!!(f.useSocialTagline||!1)),tsfTitle.updateStateFor(c,"additionValue",tsf.escapeString(tsf.decodeEntities(f.additionValue.trim()))),tsfTitle.updateStateFor(c,"additionPlacement",f.additionPlacement),tsfTitle.updateStateFor(c,"hasLegacy",!!(f.hasLegacy||!1));a(e).on("change",d=>{let e=tsfTitle.getStateFor(c,"addAdditions"),f=!a(d.target).is(":checked");b.params.additionsForcedDisabled?f=!1:b.params.additionsForcedEnabled&&(f=!0),e!==f&&tsfTitle.updateStateFor(c,"addAdditions",f)}).trigger("change");const g=a=>{let b=tsfTitle.getStateFor(c,"prefixValue"),d="";switch(a){case"password":d=tsfTitle.protectedPrefix;break;case"private":d=tsfTitle.privatePrefix;break;default:case"public":d="";}d!==b&&tsfTitle.updateStateFor(c,"prefixValue",d)};a(document).on("tsf-updated-gutenberg-visibility",(a,b)=>g(b));a("#visibility .save-post-visibility").on("click",()=>{let b=a("#visibility").find("input:radio:checked").val();if("password"===b){let c=a("#visibility").find("#post_password").val();c&&c.length||(b="public")}g(b)}),b.states.isPrivate?g("private"):b.states.isProtected&&g("password");const h=a=>{a="string"==typeof a&&a.trim()||"";let d=b.params.stripTitleTags?tsf.stripTags(a):a;d=d||tsfTitle.untitledTitle,tsfTitle.updateStateFor(c,"defaultTitle",d)};b.params.isFront||(a("#titlewrap #title").on("input",a=>h(a.target.value)),a(document).on("tsf-updated-gutenberg-title",(a,b)=>h(b))),tsfTitle.enqueueUnregisteredInputTrigger(c)},l=()=>{let a=JSON.parse(document.getElementById("tsf-description-data_"+d).dataset.state);tsfDescription.setInputElement(document.getElementById(d)),tsfDescription.updateStateFor(d,"allowReferenceChange",!a.refDescriptionLocked),tsfDescription.updateStateFor(d,"defaultDescription",tsf.escapeString(a.defaultDescription.trim())),tsfDescription.updateStateFor(d,"hasLegacy",!!(a.hasLegacy||!1)),tsfDescription.enqueueUnregisteredInputTrigger(d)},m=()=>{const b=()=>{tsfTitle.enqueueUnregisteredInputTrigger(c),tsfDescription.enqueueUnregisteredInputTrigger(d)};a(document).on("postbox-toggled",function(a,c){if("tsf-inpost-box"===c.id){let a=c.querySelector(".inside");0<a.offsetHeight&&0<a.offsetWidth&&b()}}),a("#tsf-flex-inpost-tab-general").on("tsf-flex-tab-toggled",b),a(window).on("tsf-flex-resize",b)},n=()=>{b.states.isGutenbergPage&&(tsfTT.addBoundary("#editor"),a(document).on("tsf-gutenberg-sidebar-opened",()=>{tsfTT.addBoundary(".edit-post-sidebar .components-panel")}))},o=()=>{if(!b.states.isGutenbergPage)return;const c=document.querySelector(".tsf-seo-bar"),e=document.querySelector("#tsf-doing-it-right-wrap .tsf-ajax"),f=document.getElementById(d),g=document.getElementById("autodescription_og_description"),h=document.getElementById("autodescription_twitter_description"),i=document.getElementById("autodescription_socialimage-url"),j={seobar:!!c,metadescription:!!f,ogdescription:!!g,twdescription:!!h,imageurl:!!i},k=b=>{switch(b=tsf.convertJSONResponse(b),b.type){case"success":const j=75;setTimeout(()=>{tsfDescription&&tsfDescription.updateStateFor(d,"defaultDescription",tsf.escapeString(b.data.metadescription.trim())),tsfSocial&&(tsfSocial.updateState("ogDescPlaceholder",tsf.escapeString(b.data.ogdescription.trim())),tsfSocial.updateState("twDescPlaceholder",tsf.escapeString(b.data.twdescription.trim()))),a(f).attr("placeholder",b.data.metadescription).trigger("input"),a(g).attr("placeholder",b.data.ogdescription).trigger("input"),a(h).attr("placeholder",b.data.twdescription).trigger("input"),a(i).attr("placeholder",b.data.imageurl).trigger("change"),"tsfAys"in window&&tsfAys.reset()},j),a(c).fadeOut(j,()=>{e&&tsf.unsetAjaxLoader(e,!0)}).html(b.data.seobar).fadeIn(500,tsfTT.triggerReset);break;case"failure":e&&tsf.unsetAjaxLoader(e,!1);break;default:e&&tsf.resetAjaxLoader(e);}},l=()=>{e&&tsf.unsetAjaxLoader(e,!1)};a(window).on("tsf-gutenberg-onsave",()=>{e&&tsf.resetAjaxLoader(e),e&&tsf.setAjaxLoader(e);let c={method:"POST",url:ajaxurl,datatype:"json",data:{action:"the_seo_framework_update_post_data",nonce:tsf.l10n.nonces.edit_posts,post_id:b.states.id,get:j},async:!0,timeout:7e3,success:k,error:l};a.ajax(c)})},p=()=>{j(),k(),l(),m()},q=()=>{i(),g(),n(),o(),tsfSocial.initTitleInputs({ref:document.getElementById("tsf-title-reference_"+c),refNa:document.getElementById("tsf-title-noadditions-reference_"+c),meta:document.getElementById(c),og:document.getElementById("autodescription_og_title"),tw:document.getElementById("autodescription_twitter_title")}),tsfSocial.initDescriptionInputs({ref:document.getElementById("tsf-description-reference_"+d),meta:document.getElementById(d),og:document.getElementById("autodescription_og_description"),tw:document.getElementById("autodescription_twitter_description")})};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",p),document.body.addEventListener("tsf-ready",q),a(".tsf-flex-nav-tab-radio").on("change",f),a(".tsf-flex-nav-tab-wrapper").on("click.tsfFlexNav",".tsf-flex-nav-tab-label",h)}},{},{l10n:b})}(jQuery),jQuery(window.tsfPost.load);
